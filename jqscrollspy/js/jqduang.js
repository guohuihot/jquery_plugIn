/**
* author : ahuing
* date   : 2015-04-10
* name   : jqDuang v1.1
* modify : 2015-7-29 00:16:30
 */

 !function(a){function c(c){return"index"==c?this.data("jqDuang").index:this.each(function(){var d=a(this),e=d.data("jqDuang"),f="object"==typeof c&&c;e||(d.data("jqDuang",e=new b(this,f)),e.init()),"string"==typeof c?e[c]():"number"==typeof c&&e.play(e.loopNext=c)})}var d,b=function(c,d){this.o=a.extend({},b.defaults,d),this.$self=a(c);var e=this.o.obj.split("|");this.$obj=this.$self.find(e[0]),this.$objExt=a(e[1]),this.$obj.length||(this.$obj=this.$objExt,this.$objExt=[]),this.direction=a.inArray(this.o.effect,["left","leftLoop","leftMarqueue"])<0&&"top"||"left",this.objAttr="top"==this.direction&&"height"||"width",this.index=this.o.index,this.effect=this.o.effect.replace(this.direction,""),this.L=this.$obj.length,this.pages=!this.effect&&Math.ceil((this.L-this.o.visible)/this.o.steps)+1||Math.ceil(this.L/this.o.steps),this.WH={width:this.$obj.outerWidth(!0),height:this.$obj.outerHeight(!0)}};b.defaults={obj:"li",cell:"",trigger:"mouseover",effect:"fade",speed:400,index:0,autoplay:1,interval:3e3,prevbtn:"",nextbtn:"",delay:150,easing:"swing",visible:1,steps:1,overstop:1,showtit:0,pagewrap:"",btnLoop:1,wheel:0,actclass:"act"},b.prototype={init:function(){function o(d){var e=b.$self.find(c[d+"btn"]);return!(1*c.btnLoop)&&"prev"==d&&e.addClass("disabled"),e["Marqueue"==b.effect?c.trigger:"click"](function(){a(this).hasClass("disabled")||(b.s="next"==d?-1:1,"Marqueue"==b.effect?b.next():b[d]())}).attr({unselectable:"on",onselectstart:"return false;"}),!0}var g,h,i,j,k,l,m,n,b=this,c=b.o,d=b.$obj,e=d.parent(),f=e.parent();if(!(b.pages<=1||b.L<=c.visible)){switch(!c.speed&&(b.effect="fade"),b.effect){case"fade":d.css({display:"none"}).eq(c.index).show();break;case"fold":d.css({position:"absolute",display:"none",left:0,top:0}).eq(c.index).show(),g=b.WH,g["position"]="relative",f.css(g);break;case"weibo":e.css("position","relative"),g={position:"relative",overflow:"hidden"},g[b.objAttr]=c.wrapsize||b.WH[this.objAttr]*c.visible,f.css(g);break;case"Marqueue":default:d.css({"float":"left"}),h={position:"relative",overflow:"hidden"},h[b.direction]=-b.WH[b.objAttr]*c.index,h[b.objAttr]=9999,b.effect&&(b.$obj=e.append(d.slice(0,c.visible).clone()).prepend(d.slice(d.length-c.visible).clone()).children(),h[b.direction]=-(c.visible+c.index*c.steps)*b.WH[b.objAttr],"Marqueue"==b.effect&&(b.s=-1,b.scrollSize=b.WH[b.objAttr]*b.L)),e.css(h),g={overflow:"hidden"},i=d.eq(0),j=parseInt(i.css("margin-"+this.direction))-parseInt(i.css("margin-"+("left"==this.direction?"right":"bottom"))),g[b.objAttr]=c.wrapsize||b.WH[b.objAttr]*c.visible+j,f.css(g)}if(c.cell&&"Marqueue"!=b.effect){if(l=c.cell.split("|"),b.$cells=l.length>1?b.$self.find(l[1]):b.$self.find(l[0]).children(),b.$cells.length)b.$cells=b.$cells.slice(0,b.pages);else{for(m="",n=0;n<b.pages;n++)m+="<i>"+(n+1)+"</i>";b.$cells=a(m).appendTo(l[0])}b.$cells[c.trigger](function(){return clearTimeout(k),b.loopNext=b.$cells.index(this),k=setTimeout(a.proxy(function(){b.play(b.loopNext)},b),c.delay),"click"==c.trigger?!1:void 0}).eq(b.index).addClass(c.actclass)}1*c.autoplay&&(b.start(),1*c.overstop&&(e.add(b.$cells).on("mouseover",function(){b.stop()}).on("mouseout",function(){b.start()}),c.prevbtn&&"Marqueue"!=b.effect&&b.$self.find(c.prevbtn+","+c.nextbtn).on("mouseover mouseout",function(a){e.trigger(a.type)}))),1*c.showtit&&1==c.visible&&f.after('<a class="txt" target="_blank" href="'+d.eq(c.index).data("url")+'">'+d.eq(c.index).data("title")+"</a>"),c.pagewrap&&b.$self.find(c.pagewrap).html(1*b.index+1+"/"+b.pages),c.prevbtn&&o("prev")&&o("next"),1*c.wheel&&a.fn.mousewheel&&f.mousewheel(function(c,d){clearTimeout(k),k=setTimeout(a.proxy(function(){b[d>0?"prev":"next"]()},b),100)}),b.$objExt.length>c.index&&b.$objExt.css("display","none").eq(c.index).show()}},start:function(){this.t1=setInterval(a.proxy(this.next,this),this.o.interval)},stop:function(){clearInterval(this.t1)},next:function(){this.play("Marqueue"!=this.effect&&(this.loopNext=this.index+1)%this.pages)},prev:function(){this.loopNext=this.index-1,this.play((this.loopNext+this.pages)%this.pages)},play:function(b){var h,i,j,k,l,m,c=this,d=c.o,e=c.$obj,f=e.parent(),g=c.loopNext;if(c.index!=b||"Marqueue"==c.effect){switch(c.$self.trigger("beforeFun"),c.effect){case"fade":e.eq(c.index).hide(),e.eq(b).animate({opacity:"show"},d.speed,d.easing);break;case"fold":e.stop(!0,!0).eq(c.index).animate({opacity:"hide"},d.speed,d.easing),e.eq(b).animate({opacity:"show"},d.speed,d.easing);break;case"Marqueue":f.css(c.direction,function(a,b){var d=parseInt(b)+c.s;return d<=-c.scrollSize?d=0:d>=0&&(d=-c.scrollSize),d});break;case"weibo":h={},h[c.direction]=9*c.WH[c.objAttr]/8,f.stop(!0,!0).animate(h,d.speed,d.easing,function(){var b=f.children()[e.length-1];b.style.display="none",f[0].insertBefore(b,f[0].children[0]),f[0].style.top=0,a(b).fadeIn()});break;default:if(i=0,"Loop"==this.effect){if(f.is(":animated"))return!1;k=c.L%d.steps,k&&g==c.pages?i=k-d.steps:k&&-1==g&&(i=d.steps-k),j=g*d.steps+d.visible+i,l=function(){f.css(c.direction,-c.WH[c.objAttr]*(b*d.steps+d.visible))}}else(g==c.pages-1||-1==g)&&(i=c.L-b*d.steps-d.visible);h={},h[c.direction]=-c.WH[c.objAttr]*("Loop"==this.effect?j:b*d.steps+i),f.stop(!0).animate(h,d.speed,d.easing,l)}1*d.showtit&&1==d.visible&&(m=e.eq(b+("Loop"==this.effect?1:0)).data(),c.$self.find(".txt").html(m.title)[0].href=m.url),d.pagewrap&&c.$self.find(d.pagewrap).html(b+1+"/"+c.pages),d.cell&&c.$cells.removeClass(d.actclass).eq(b).addClass(d.actclass),c.$objExt.length>b&&c.$objExt.css("display","none").eq(b).show(),c.index=b,1*d.btnLoop||!d.prevbtn||(c.$self.find(d.prevbtn+","+d.nextbtn).removeClass("disabled"),0==b&&c.$self.find(d.prevbtn).addClass("disabled"),b==c.pages-1&&c.$self.find(d.nextbtn).addClass("disabled")),c.$self.trigger("afterFun",[b])}}},d=a.fn.jqDuang,a.fn.jqDuang=c,a.fn.jqDuang.Constructor=b,a.fn.jqDuang.noConflict=function(){return a.fn.jqDuang=d,this},a(window).on("load",function(){a(".jqDuang").each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery);